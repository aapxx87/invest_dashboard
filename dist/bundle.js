(()=>{"use strict";const e=[{stockTicker:"fxit.me",currency:"rub",buyDate:"27.12.2021",end2021Price:1,buyYear:"2021",buyPrice:12400,volume:1,usdRubRateBuyDate:73.4,benchMark:"fxit.me",benchMarkStartPrice:12400},{stockTicker:"orcl",currency:"usd",buyDate:"13.12.2021",buyYear:"2021",buyPrice:102.49,volume:1,usdRubRateBuyDate:73.56,benchMark:"fxit.me",benchMarkStartPrice:12290},{stockTicker:"u",currency:"usd",buyDate:"12.11.2021",buyYear:"2021",buyPrice:187.2,volume:1,usdRubRateBuyDate:72.97,benchMark:"fxit.me",benchMarkStartPrice:12082},{stockTicker:"rblx",currency:"usd",buyDate:"03.11.2021",buyYear:"2021",buyPrice:78.72,volume:2,usdRubRateBuyDate:73.09,benchMark:"fxit.me",benchMarkStartPrice:11696},{stockTicker:"nvda",currency:"usd",buyDate:"10.07.2020",buyYear:"2020",end2020Price:130.55,buyPrice:104.35,volume:4,usdRubRateBuyDate:73,benchMark:"fxit.me",benchMarkStartPrice:7618},{stockTicker:"fb",currency:"usd",buyDate:"25.03.2020",end2020Price:273.16,buyYear:"2020",buyPrice:160.14,volume:1,usdRubRateBuyDate:80.32,benchMark:"fxit.me",benchMarkStartPrice:5857},{stockTicker:"mtch",currency:"usd",buyDate:"25.03.2020",end2020Price:151.19,buyYear:"2020",buyPrice:63.99,volume:1,usdRubRateBuyDate:66.57,benchMark:"fxit.me",benchMarkStartPrice:5857},{stockTicker:"aapl",currency:"usd",buyDate:"25.02.2020",end2020Price:132.69,buyYear:"2020",buyPrice:73.22,volume:4,usdRubRateBuyDate:67,benchMark:"fxit.me",benchMarkStartPrice:5993},{stockTicker:"tcsg.me",currency:"rub",buyDate:"10.01.2020",end2020Price:2366,buyYear:"2020",buyPrice:1370,lastPrice:6848,volume:2,usdRubRateBuyDate:66.57,benchMark:"fxit.me",benchMarkStartPrice:5638},{stockTicker:"yndx.me",currency:"rub",buyDate:"10.01.2020",end2020Price:5156,buyYear:"2020",buyPrice:2732,lastPrice:5612,volume:1,usdRubRateBuyDate:66.57,benchMark:"fxit.me",benchMarkStartPrice:5675},{stockTicker:"fxit.me",currency:"rub",buyDate:"10.01.2020",end2020Price:9609,buyYear:"2020",buyPrice:5675,lastPrice:12382,volume:1,usdRubRateBuyDate:66.57,benchMark:"fxit.me",benchMarkStartPrice:5675}],t=document.querySelector(".stocks"),r=document.querySelector(".portfolio-balances"),c=document.querySelector(".year_2021"),n=document.querySelector(".year_2020"),a=document.querySelector(".balances-item-2020"),u=function(e){const t=e.filter((function(e){return"2020"===e.buyYear})),r=[];console.log(t),t.forEach((function(e){"usd"===e.currency&&r.push(e.buyPrice*e.volume*e.usdRubRateBuyDate),r.push(e.buyPrice*e.volume)}));return r.reduce((function(e,t){return e+t}))},s=function(e){const t=e.filter((function(e){return"2020"===e.buyYear})),r=[];t.forEach((function(e){"usd"===e.currency?r.push(e.end2020Price*e.volume*e.usdRubRateBuyDate):"rub"===e.currency&&r.push(e.end2020Price*e.volume)}));return r.reduce((function(e,t){return e+t}))};a.textContent=`${((s(e)-u(e))/(u(e)/100)).toFixed(1)} %`;const o=document.querySelector(".balances-item-2021");!function(){const t=s(e)+function(e){const t=e.filter((function(e){return"2021"===e.buyYear})),r=[];t.forEach((function(e){"usd"===e.currency?r.push(e.buyPrice*e.volume*e.usdRubRateBuyDate):"rub"===e.currency&&r.push(e.buyPrice*e.volume)}));return r.reduce((function(e,t){return e+t}))}(e);setTimeout((function(){const e=(Number(document.querySelector(".last-balance").textContent.slice(0,-5).replace(/\s+/g,""))-t)/(t/100);o.textContent=`${e.toFixed(1)} %`}),4e3)}(),document.querySelector(".container-portfolio-quotes");const i=[],l=[],b=["nvda","rblx","aapl","fxit.me","yndx.me","tcsg.me","mtch","fb","u","orcl","RUB=X"],m=async function(e){console.log("Start fetch API stock data");const t=await fetch(`https://yh-finance.p.rapidapi.com/market/v2/get-quotes?region=US&symbols=${e}`,{method:"GET",headers:{"x-rapidapi-host":"yh-finance.p.rapidapi.com","x-rapidapi-key":"8caa20872cmsh50a9c8ee420964ep1ae65ejsne134ec66d0a1"}});return(await t.json()).quoteResponse.result};m(b.map((function(e){return e+"%2C"})).join("")),async function(){document.querySelector(".container-portfolio-quotes").insertAdjacentHTML("afterbegin",'\n    <div class="spinner">\n            <svg class="loading-spinner" xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 48 48">\n      <g fill="none">\n        <path id="track" fill="#C6CCD2" d="M24,48 C10.745166,48 0,37.254834 0,24 C0,10.745166 10.745166,0 24,0 C37.254834,0 48,10.745166 48,24 C48,37.254834 37.254834,48 24,48 Z M24,44 C35.045695,44 44,35.045695 44,24 C44,12.954305 35.045695,4 24,4 C12.954305,4 4,12.954305 4,24 C4,35.045695 12.954305,44 24,44 Z"/>\n        <path id="section" fill="#3F4850" d="M24,0 C37.254834,0 48,10.745166 48,24 L44,24 C44,12.954305 35.045695,4 24,4 L24,0 Z"/>\n      </g>\n    </svg>\n    <p>Loading data. Please wait.</p>\n    </div>\n  ');const a=await m(b),u=a.slice(0,-1),s=a.pop().regularMarketPrice;let o;const y=a.filter((function(e){return"FXIT.ME"===e.symbol}))[0].regularMarketPrice,d=[];var p;e.forEach((function(e){let t;u.forEach((function(r){r.symbol===e.stockTicker.toUpperCase()&&(t=r.regularMarketPrice)}));const r=t-e.buyPrice;"usd"===e.currency&&(i.push(+e.volume*t*s).toFixed(2),l.push(e.buyPrice*e.volume*e.usdRubRateBuyDate)),"rub"===e.currency&&(i.push(+(e.volume*t).toFixed(2)),l.push(e.buyPrice*e.volume));const a=i.reduce((function(e,t){return e+t}),0).toFixed(2),b=l.reduce((function(e,t){return e+t}),0).toFixed(2),m=(y-e.benchMarkStartPrice)/(e.benchMarkStartPrice/100),p={pnl:r,buyDate:e.buyDate,buyYear:e.buyYear,currency:e.currency,ticker:e.stockTicker.toUpperCase(),volume:e.volume,buyPrice:new Intl.NumberFormat("ru-RU").format(e.buyPrice),lastPrice:new Intl.NumberFormat("ru-RU").format(t.toFixed(2)),totalVolumePrice:new Intl.NumberFormat("ru-RU").format((e.volume*t).toFixed(2)),deltaMoney:new Intl.NumberFormat("ru-RU").format((r*e.volume).toFixed(2)),deltaPercent:((t-e.buyPrice)/(e.buyPrice/100)).toFixed(2),benchMarkDeltaPercent:m.toFixed(0),benchMarkName:"FXIT.ME"};d.push(p),o={startAmount:new Intl.NumberFormat("ru-RU").format(b),lastAmount:new Intl.NumberFormat("ru-RU").format(a),totalDelta:new Intl.NumberFormat("ru-RU").format(a-b),totalDeltaPercent:((a-b)/(b/100)).toFixed(0)},document.querySelector(".spinner").style.display="none",function(e){let t;"2020"===e.buyYear&&(t=`\n         <li class="item-row row-investments ${e.pnl>0?"profit":"loss"}">\n          <p class="balances-item2 ticker">${e.ticker}</p>\n          <p class="balances-item">${e.deltaPercent} %</p>\n          <p class="balances-item2">${e.benchMarkDeltaPercent} %</p>\n          <p class="balances-item">${e.lastPrice} ${"usd"===e.currency?"$":"P"}</p>\n          <p class="balances-item2 small-number">${e.buyPrice} ${"usd"===e.currency?"$":"P"}</p>\n          <p class="balances-item2 small-number">${e.buyDate}</p>\n          <p class="balances-item2 small-number">${e.volume}</p>\n          <p class="balances-item2 small-number">${e.totalVolumePrice} ${"usd"===e.currency?"$":"P"}</p>\n         </li>\n        `,n.insertAdjacentHTML("beforeend",t)),"2021"===e.buyYear&&(t=`\n         <li class="item-row row-investments ${e.pnl>0?"profit":"loss"}">\n          <p class="balances-item2 ticker">${e.ticker}</p>\n          <p class="balances-item">${e.deltaPercent} %</p>\n          <p class="balances-item2">${e.benchMarkDeltaPercent} %</p>\n          <p class="balances-item">${e.lastPrice} ${"usd"===e.currency?"$":"P"}</p>\n          <p class="balances-item2 small-number">${e.buyPrice} ${"usd"===e.currency?"$":"P"}</p>\n          <p class="balances-item2 small-number">${e.buyDate}</p>\n          <p class="balances-item2 small-number">${e.volume}</p>\n          <p class="balances-item2 small-number">${e.totalVolumePrice} ${"usd"===e.currency?"$":"P"}</p>\n         </li>\n        `,c.insertAdjacentHTML("beforeend",t))}(p)})),p=d,e.forEach((function(e,r){let c;p.forEach((function(t){e.stockTicker.toUpperCase()===t.ticker&&e.buyDate===t.buyDate&&(c=t)}));let n=(.7*+c.deltaPercent).toFixed(0);const a=document.createElement("div");a.classList.add("box-stock"),a.style.backgroundColor="#80E5A4";let u=0;"usd"===e.currency?u=e.volume*e.buyPrice*e.usdRubRateBuyDate:"rub"===e.currency&&(u=e.volume*e.buyPrice);const s=(u/300).toFixed(0);if(a.style.width=s+"px",n>0)a.style.height=n+"px",a.innerHTML=`<p class="box-stock-ticker" style="transform: translateY(-25px) ;">${e.stockTicker}</p>`;else{const t=n.toString().substring(1);a.style.height=t+"px",a.style.transform=`translateY(${t}px)`,a.style.backgroundColor="rgb(243, 109, 109)",a.innerHTML=`<p class="box-stock-ticker" style="transform: translateY(-30px) ;">${e.stockTicker}</p>`}t.append(a)})),function(e){const t=`\n       \n           <li class="item-row">\n            <p class="balances-item last-balance">${e.lastAmount} P</p>\n            <p class="balances-item">${e.startAmount} P</p>\n            <p class="balances-item">${e.totalDeltaPercent} %</p>\n            <p class="balances-item">${e.totalDelta} P</p>\n          </li>\n  `;r.insertAdjacentHTML("beforeend",t)}(o)}()})();